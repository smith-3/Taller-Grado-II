%%{init: {
  "theme": "base",
  "themeVariables": {
    "fontFamily": "Arial, sans-serif",
    "fontSize": "14px"
  }
}}%%
sequenceDiagram
    autonumber

    participant OBS as ClassReminderSyncObserver
    participant SIMON as SimonScheduler
    participant NOTIF as NotificationService
    participant U as Usuario
    participant REC as NotificationActionReceiver
    participant AIU as AiModelUsageManager
    participant USE as SimonNotificationUseCase
    participant SHOW as ShowNotificationUseCase

    %% --- Sincronización de recordatorios ---
    OBS->>OBS: Detecta cambio<br/>en el horario
    OBS->>SIMON: onScheduleChanged()
    SIMON->>NOTIF: cancelOldReminders()
    SIMON->>NOTIF: scheduleNewReminders()

    %% --- Interacción con el usuario ---
    U->>REC: Acción en notificación<br/>(Simón / Like)

    %% --- Manejo de acción ---
    REC->>AIU: withLease(...)
    AIU->>USE: generateReminderClosure()<br/>/ generateCheckInClosure()
    USE-->>REC: NotificationInfo

    %% --- Mostrar nueva notificación ---
    REC->>SHOW: showNotification(info)
    SHOW->>NOTIF: notify()
