flowchart TD
    A[Usuario presiona exportar] --> B{¿Hay materias inscritas?}
    B -->|No| C[Mostrar mensaje bloqueo]
    C --> D[Fin - No exportar]
    
    B -->|Sí| E[Mostrar diálogo opciones]
    E --> F{¿Qué formato?}
    F -->|PDF| G[GenerarWeeklySchedulePdfUseCase]
    F -->|Imagen| H[GenerateWeeklyScheduleImageUseCase]
    F -->|Excel| I[GenerateScheduleExcelUseCase]
    
    G --> J[Obtener datos del horario]
    H --> J
    I --> J
    
    J --> K[Crear archivo temporal]
    K --> L[Mostrar diálogo confirmación]
    L --> M{¿Confirmar?}
    M -->|Sí| N[Guardar archivo]
    M -->|No| O[Cancelar exportación]
    
    N --> P[Mostrar éxito]
    P --> Q[Ofrecer compartir]