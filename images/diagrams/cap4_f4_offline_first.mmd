flowchart TD
    A[App solicita datos] --> B{Cache local válido?}
    B -->|Sí| C[Usar datos cacheados]
    B -->|No| D[Validador de frescura]
    D --> E{¿Datos frescos?}
    E -->|Sí| F[Usar cache]
    E -->|No| G[Intentar servidor]
    G --> H{Circuit breaker abierto?}
    H -->|Sí| I[Usar PDF fallback]
    H -->|No| J[Llamar API servidor]
    J --> K{Éxito?}
    K -->|Sí| L[Actualizar cache]
    K -->|No| M[Activar backoff]
    M --> N[Incrementar contador fallos]
    N --> O{¿Límite backoff?}
    O -->|Sí| P[Abrir circuit breaker]
    O -->|No| Q[Esperar backoff exponencial]
    Q --> R[Reintentar servidor]
    P --> I
    I --> S[Parsear PDF local]
    S --> T{Éxito parsing?}
    T -->|Sí| U[Usar datos PDF]
    T -->|No| V[Mostrar error offline]